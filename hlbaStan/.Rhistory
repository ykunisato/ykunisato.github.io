library(ggplot2)
library(plotly)
library(bayesplot)
# Stan用
library(rstan)
library(loo)
# Linear Ballistic Accumulator model用データの生成
library(rtdists)
# 参加者数
numberSubject <- 10
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
install.packages("msm")
library(DiagrammeR)
library(ggplot2)
library(plotly)
library(bayesplot)
library(rstan)
library(loo)
library(rtdists)
library(msm)
# 参加者数
numberSubject <- 10
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
k = rtnorm(numberSubject,k_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
A
# 参加者数
numberSubject <- 10
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
k = rtnorm(numberSubject,k_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
parameter <- data.farame(k,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
# 参加者数
numberSubject <- 10
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
k = rtnorm(numberSubject,k_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
parameter <- data.frame(k,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameter)
# 参加者数
numberSubject <- 10
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
hyperParameters <- data.frame(A_mu,k_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
k = rtnorm(numberSubject,k_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
parameter <- data.frame(k,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameter)
parameters$k[1]
parameter$k[1]
# 参加者数
numberSubject <- 10
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
hyperParameters <- data.frame(A_mu,k_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
k = rtnorm(numberSubject,k_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
parameters <- data.frame(k,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
k = rtnorm(numberSubject,k_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,k_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(k,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
k_mu = .5
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
k = rtnorm(numberSubject,k_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,k_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,k,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,k,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,0,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
i<-1
rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2
v1_mu_c2 = 3
v2_mu_c2 = 2
v1_mu_c3 = 4
v2_mu_c3 = 2
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
A-b
rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
i<-2
rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
id <- rep(i,numberTrials)
id
indData <- data.frame(tempRt,id)
i <-1
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
id <- rep(i,numberTrials)
indData <- data.frame(tempRt,id)
indData
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2.5
v1_mu_c2 = 3
v2_mu_c2 = 3
v1_mu_c3 = 3.5
v2_mu_c3 = 2.5
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
rm(list=ls())
library(DiagrammeR)
library(ggplot2)
library(plotly)
library(bayesplot)
library(rstan)
library(loo)
library(rtdists)
library(msm)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2.5
v1_mu_c2 = 3
v2_mu_c2 = 3
v1_mu_c3 = 3.5
v2_mu_c3 = 2.5
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
i <- 1
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indData1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indData2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indData3 <- data.frame(id,condition,tempRt)
rbind(indData1,indData2,indData3)
longData <- NULL
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
longData <- rbind(longData,indData)
rm(list=ls())
library(DiagrammeR)
library(ggplot2)
library(plotly)
library(bayesplot)
library(rstan)
library(loo)
library(rtdists)
library(msm)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2.5
v1_mu_c2 = 3
v2_mu_c2 = 3
v1_mu_c3 = 3.5
v2_mu_c3 = 2.5
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
set.seed(1234)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
head(longData)
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
set.seed(1234)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
longData
