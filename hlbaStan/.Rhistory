s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
i <- 1
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indData1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indData2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indData3 <- data.frame(id,condition,tempRt)
rbind(indData1,indData2,indData3)
longData <- NULL
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
longData <- rbind(longData,indData)
rm(list=ls())
library(DiagrammeR)
library(ggplot2)
library(plotly)
library(bayesplot)
library(rstan)
library(loo)
library(rtdists)
library(msm)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2.5
v1_mu_c2 = 3
v2_mu_c2 = 3
v1_mu_c3 = 3.5
v2_mu_c3 = 2.5
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
set.seed(1234)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
head(longData)
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
set.seed(1234)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
longData
rm(list=ls())
library(DiagrammeR)
library(ggplot2)
library(plotly)
library(bayesplot)
library(rstan)
library(loo)
library(rtdists)
library(msm)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2.5
v1_mu_c2 = 3
v2_mu_c2 = 3
v1_mu_c3 = 3.5
v2_mu_c3 = 2.5
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
set.seed(1234)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
head(longData)
dataSub5 <- subset(longData,longData$id==5)
dataSub5Con1 <- subset(dataSub5,dataSub5$condition==1)
dataSub5Con2 <- subset(dataSub5,dataSub5$condition==2)
dataSub5Con3 <- subset(dataSub5,dataSub5$condition==3)
dataSub5Con1
dataSub5Con2
dataSub5Con3
# 参加者IDが５の人の各条件のデータを作る。
dataSub5 <- subset(longData,longData$id==5)
dataSub5Con1 <- subset(dataSub5,dataSub5$condition==1)
dataSub5Con2 <- subset(dataSub5,dataSub5$condition==2)
dataSub5Con3 <- subset(dataSub5,dataSub5$condition==3)
# 条件１
table(dataSub5Con1$response)
# 条件２
table(dataSub5Con2$response)
# 条件３
table(dataSub5Con3$response)
# 参加者IDが５の人の各条件のデータを作る。
dataSub4 <- subset(longData,longData$id==4)
dataSub5Con1 <- subset(dataSub5,dataSub5$condition==1)
dataSub5Con2 <- subset(dataSub5,dataSub5$condition==2)
dataSub5Con3 <- subset(dataSub5,dataSub5$condition==3)
# 条件１
table(dataSub5Con1$response)
# 条件２
table(dataSub5Con2$response)
# 条件３
table(dataSub5Con3$response)
# 参加者IDが５の人の各条件のデータを作る。
dataSub4 <- subset(longData,longData$id==4)
dataSub4Con1 <- subset(dataSub4,dataSub4$condition==1)
dataSub4Con2 <- subset(dataSub4,dataSub4$condition==2)
dataSub4Con3 <- subset(dataSub4,dataSub4$condition==3)
# 条件１
table(dataSub4Con1$response)
# 条件２
table(dataSub4Con2$response)
# 条件３
table(dataSub4Con3$response)
# 参加者IDが５の人の各条件のデータを作る。
dataSub6 <- subset(longData,longData$id==6)
dataSub6Con1 <- subset(dataSub6,dataSub6$condition==1)
dataSub6Con2 <- subset(dataSub6,dataSub6$condition==2)
dataSub6Con3 <- subset(dataSub6,dataSub6$condition==3)
# 条件１
table(dataSub4Con1$response)
# 条件２
table(dataSub4Con2$response)
# 条件３
table(dataSub4Con3$response)
# 条件１
table(dataSub6Con1$response)
# 条件２
table(dataSub6Con2$response)
# 条件３
table(dataSub6Con3$response)
# 条件１
table(dataSub6Con1$response)
# 条件２
table(dataSub6Con2$response)
# 条件３
table(dataSub6Con3$response)
# 参加者IDが５の人の各条件のデータを作る。
dataSub1 <- subset(longData,longData$id==6)
dataSub1Con1 <- subset(dataSub1,dataSub1$condition==1)
dataSub1Con2 <- subset(dataSub1,dataSub1$condition==2)
dataSub1Con3 <- subset(dataSub1,dataSub1$condition==3)
# 条件１
table(dataSub1Con1$response)
# 条件２
table(dataSub1Con2$response)
# 条件３
table(dataSub1Con3$response)
# 参加者IDが５の人の各条件のデータを作る。
dataSub1 <- subset(longData,longData$id==1)
dataSub1Con1 <- subset(dataSub1,dataSub1$condition==1)
dataSub1Con2 <- subset(dataSub1,dataSub1$condition==2)
dataSub1Con3 <- subset(dataSub1,dataSub1$condition==3)
# 条件１
table(dataSub1Con1$response)
# 条件２
table(dataSub1Con2$response)
# 条件３
table(dataSub1Con3$response)
# 条件１
table(dataSub1Con1$response)
# 条件２
table(dataSub1Con2$response)
# 条件３
table(dataSub1Con3$response)
# 参加者IDが５の人の各条件のデータを作る。
dataSub1 <- subset(longData,longData$id==1)
dataSub1Con1 <- subset(dataSub1,dataSub1$condition==1)
dataSub1Con2 <- subset(dataSub1,dataSub1$condition==2)
dataSub1Con3 <- subset(dataSub1,dataSub1$condition==3)
set.seed(123)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
# 参加者IDが５の人の各条件のデータを作る。
dataSub1 <- subset(longData,longData$id==1)
dataSub1Con1 <- subset(dataSub1,dataSub1$condition==1)
dataSub1Con2 <- subset(dataSub1,dataSub1$condition==2)
dataSub1Con3 <- subset(dataSub1,dataSub1$condition==3)
# 条件１
table(dataSub1Con1$response)
# 条件２
table(dataSub1Con2$response)
# 条件３
table(dataSub1Con3$response)
set.seed(123)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
# 参加者IDが５の人の各条件のデータを作る。
dataSub1 <- subset(longData,longData$id==1)
dataSub1Con1 <- subset(dataSub1,dataSub1$condition==1)
dataSub1Con2 <- subset(dataSub1,dataSub1$condition==2)
dataSub1Con3 <- subset(dataSub1,dataSub1$condition==3)
# 条件１
table(dataSub1Con1$response)
# 条件２
table(dataSub1Con2$response)
# 条件３
table(dataSub1Con3$response)
set.seed(123)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2.5
v1_mu_c2 = 3
v2_mu_c2 = 3
v1_mu_c3 = 3.5
v2_mu_c3 = 2.5
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
# 参加者IDが５の人の各条件のデータを作る。
dataSub1 <- subset(longData,longData$id==1)
dataSub1Con1 <- subset(dataSub1,dataSub1$condition==1)
dataSub1Con2 <- subset(dataSub1,dataSub1$condition==2)
dataSub1Con3 <- subset(dataSub1,dataSub1$condition==3)
# 条件１
table(dataSub1Con1$response)
# 条件２
table(dataSub1Con2$response)
# 条件３
table(dataSub1Con3$response)
rm(list=ls())
library(DiagrammeR)
library(ggplot2)
library(plotly)
library(bayesplot)
library(rstan)
library(loo)
library(rtdists)
library(msm)
set.seed(123)
# 参加者数，試行数，条件数
numberSubject <- 10
numberTrials <- 100
numberConditions <- 3
#　ハイパーパラメータの設定
A_mu = .5
b_mu = 1
t0_mu = .5
v1_mu_c1 = 2
v2_mu_c1 = 2.5
v1_mu_c2 = 3
v2_mu_c2 = 3
v1_mu_c3 = 3.5
v2_mu_c3 = 2.5
s = 1
#　ハイパーパラメータをもとにした個人のパラメータ（切断正規分布を利用）
A = rtnorm(numberSubject,A_mu,.5,0,Inf)
b = rtnorm(numberSubject,b_mu,.5,A,Inf)
t0 = rtnorm(numberSubject,t0_mu,.5,0,1)
v1_c1 = rtnorm(numberSubject,v1_mu_c1,1,0,Inf)
v2_c1 = rtnorm(numberSubject,v2_mu_c1,1,0,Inf)
v1_c2 = rtnorm(numberSubject,v1_mu_c2,1,0,Inf)
v2_c2 = rtnorm(numberSubject,v2_mu_c2,1,0,Inf)
v1_c3 = rtnorm(numberSubject,v1_mu_c3,1,0,Inf)
v2_c3 = rtnorm(numberSubject,v2_mu_c3,1,0,Inf)
# パラメータとハイパーパラメータのデータフレーム化
hyperParameters <- data.frame(A_mu,b_mu,t0_mu,v1_mu_c1,v2_mu_c1,v1_mu_c2,v2_mu_c2,v1_mu_c3,v2_mu_c3,s)
print(hyperParameters)
parameters <- data.frame(A,b,t0,v1_c1,v2_c1,v1_c2,v2_c2,v1_c3,v2_c3)
print(parameters)
longData <- NULL
for(i in 1:numberSubject){
id <- rep(i,numberTrials)
# 条件１
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(1,numberTrials)
indDataC1 <- data.frame(id,condition,tempRt)
# 条件2
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(2,numberTrials)
indDataC2 <- data.frame(id,condition,tempRt)
# 条件3
tempRt <- rLBA(numberTrials, A=parameters$A[i], b=parameters$b[i], t0=parameters$t0[i], mean_v=c(parameters$v1_c1[i],parameters$v2_c1[i]), sd_v=c(s,s))
condition <- rep(3,numberTrials)
indDataC3 <- data.frame(id,condition,tempRt)
indData <- rbind(indDataC1,indDataC2,indDataC3)
# ロングデータ
longData <- rbind(longData,indData)
}
allTrial <- length(longData)
# Stan用データの作成
stanLongData <- list(RT=longData$rt,RES=longData$response,ID=longData$id,CONDITION = longData$condition, TRIAL_LENGTH=numberTrials,NUM_COND=numberConditions,NUM_SUBJ=numberSubject,NUM_CHOICES=2,ALLTRIAL=allTrial,NUM_CHOICES=2)
# 参加者IDが５の人の各条件のデータを作る。
dataSub1 <- subset(longData,longData$id==1)
dataSub1Con1 <- subset(dataSub1,dataSub1$condition==1)
dataSub1Con2 <- subset(dataSub1,dataSub1$condition==2)
dataSub1Con3 <- subset(dataSub1,dataSub1$condition==3)
# 条件１
table(dataSub1Con1$response)
# 条件２
table(dataSub1Con2$response)
# 条件３
table(dataSub1Con3$response)
# 選択肢1の反応時間
dataSub1Con1Choice1 <- subset(dataSub1Con1,dataSub1Con1$response==1)
p1 <- ggplot(dataSub1Con1Choice1,aes(x = rt)) + geom_histogram()+coord_cartesian(xlim = c(0, 3), ylim = c(0, 70))
# 選択肢2の反応時間
dataSub1Con1Choice2 <- subset(dataSub1Con1,dataSub1Con1$response==2)
p2 <- ggplot(dataSub1Con1Choice2,aes(x = rt)) + geom_histogram()+coord_cartesian(xlim = c(0, 3), ylim = c(0, 70))
subplot(p1, p2)
# 選択肢1の反応時間
dataSub1Con1Choice1 <- subset(dataSub1Con1,dataSub1Con1$response==1)
p1 <- ggplot(dataSub1Con1Choice1,aes(x = rt)) + geom_histogram()+coord_cartesian(xlim = c(0, 3), ylim = c(0, 10))
# 選択肢2の反応時間
dataSub1Con1Choice2 <- subset(dataSub1Con1,dataSub1Con1$response==2)
p2 <- ggplot(dataSub1Con1Choice2,aes(x = rt)) + geom_histogram()+coord_cartesian(xlim = c(0, 3), ylim = c(0, 10))
subplot(p1, p2)
